855555; archivo de constantes (CNS) de Goku SJJ Ordinario
;----------------------------------------------------------------------------------------------------------------------
[Data]
;cantidad de vida con la q comienza
life = 1000
;poder de ataque
attack = 100
;poder defensivo 
defence = 100
;porcentaje q se incrementa la defensa cada ves q el jugador es noqueado abajo
fall.defence_up = 50
;Time which player lies down for, before getting up
liedown.time = 60
;Number of points for juggling
airjuggle = 15
;Default hit spark number for HitDefs
sparkno = 2
;Default guard spark number
guard.sparkno = 40
;1 to enable echo on KO
KO.echo = 0
;Volume offset (negative for softer)
volume = 0
IntPersistIndex = 60
FloatPersistIndex = 40
;---------------------------------------------------------------------------------------------------
[Size]
xscale = 1           ;Horizontal scaling factor.
yscale = 1           ;Vertical scaling factor.
ground.back = 15     ;Player width (back, ground)
ground.front = 16    ;Player width (front, ground)
air.back = 12        ;Player width (back, air)
air.front = 12       ;Player width (front, air)
height = 60          ;Height of player (for opponent to jump over)
attack.dist = 160    ;Default attack distance
proj.attack.dist = 90 ;Default attack distance for projectiles
proj.doscale = 0     ;Set to 1 to scale projectiles too
head.pos = -5, -90   ;Approximate position of head
mid.pos = -5, -60    ;Approximate position of midsection
shadowoffset = 0     ;Number of pixels to vertically offset the shadow
draw.offset = 0,0    ;Player drawing offset in pixels (x, y)

[Velocity]
walk.fwd  = 6.4    ;Walk forward
walk.back = -6.2    ;Walk backward
run.fwd  = 4.6,0      ;Run forward (x, y)
run.back = -4.5,-3.8   ;Hop backward (x, y)
jump.neu = 0,-8.4    ;Neutral jumping velocity (x, y)
jump.back = -2.55    ;Jump back Speed (x, y)
jump.fwd = 2.5       ;Jump forward Speed (x, y)
runjump.back = -2.55,-8.1 ;Running jump speeds (opt)
runjump.fwd = 4,-8.1      ;.
airjump.neu = 0,-8.1      ;.
airjump.back = -2.55      ;Air jump speeds (opt)
airjump.fwd = 2.5         ;.

[Movement]
airjump.num = 0      ;Number of air jumps allowed (opt)
airjump.height =35  ;Minimum distance from ground before you can air jump (opt)
yaccel = .44         ;Vertical acceleration
stand.friction = .85  ;Friction coefficient when standing
crouch.friction = .82 ;Friction coefficient when crouching

;---------------------------------------------------------------------------
; variable usada:
; This is a record of the variables that KFM uses. Keeping a record of your
; variable usage helps you avoid careless mistakes later.
; var(1)  - Used in kfm.cmd for combo condition (updated every tick)
; var(2)  - Used in Kung Fu Throw (state 800) to remember if fwd was being
;           held (remembered from state 800 through state 810).
;---------------------------------------------------------------------------
;correr adelante y atras
[Statedef 20]
type    = S
physics = S
sprpriority = 0

[State 20]
type = makedust
trigger1 = time > 0
pos = -22,0

[State 20, 1]
type = VelSet
trigger1 = command = "holdfwd"
x = const(velocity.walk.fwd.x)

[State 20, 2]
type = VelSet
trigger1 = command = "holdback"
x = const(velocity.walk.back.x)

[State 20, 3]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 20 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 20

[State 20, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 21 && Anim != 5
trigger2 = Anim = 5 && AnimTime = 0
value = 21

;---------------------------------------------------------------------------

; camienzo Salto
[Statedef 40]
type = S
physics = S
anim = 40
ctrl = 0
sprpriority = 1

[State 40, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 40, 2]
type = VarSet
trigger1 = Time = 0
var(5) = 0

[State 40, 3]
type = VarSet
trigger1 = command = "saltolargo"
trigger2 = prevstateno = 101 && command = "holdfwd"
var(5) = 1

[State 40, 4]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 40, 5]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1

[State 40, 6]
type = VelSet
trigger1 = AnimTime = 0
x = ifelse(sysvar(1)=0, const(velocity.jump.neu.x), ifelse(sysvar(1)=1, const(velocity.jump.fwd.x), const(velocity.jump.back.x)))
y = const(velocity.jump.y)

[State 40, 9]
type = ChangeState
trigger1 = AnimTime = 0 && command != "holdup"
value = 950
ctrl = 1

[State 40, 10]
type = ChangeState
trigger1 = AnimTime = 0
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; comienzo salto en el aire
[Statedef 45]
type    = A
physics = N
ctrl = 0
velset = 0,0

[State 45, 1]
type = ChangeAnim
trigger1 = SelfAnimExist(44)
value = 44

[State 45, 2]
type = ChangeAnim
trigger1 = !SelfAnimExist(44)
value = 41

[State 45, 3]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 45, 4]
type = VarSet
trigger1 = command = "holdfwd"
sysvar(1) = 1

[State 45, 5]
type = VarSet
trigger1 = command = "holdback"
sysvar(1) = -1

[State 45, 6]
type = VelSet
trigger1 = Time = 2
x = ifelse(sysvar(1)=0, const(velocity.airjump.neu.x), ifelse(sysvar(1)=1, const(velocity.airjump.fwd.x), const(velocity.airjump.back.x)))
y = const(velocity.airjump.y)

[State 45, 7]
type = ChangeState
trigger1 = Time = 2
value = 50
ctrl = 1

;---------------------------------------------------------------------------
; Salto arriba
[Statedef 50]
type    = A
physics = A

[State 50, 1]
type = VarSet
trigger1 = Time = 0
sysvar(1) = 0

[State 50, 2]
type = VelSet
trigger1 = Time = 0 && Var(5)
x = IfElse(vel x = 0,0,IfElse(vel x < 0,-5,6))

[State 50, 3]
type = ChangeAnim
trigger1 = Time = 0
value = ifelse((vel x)=0, 41, ifelse((vel x)>0, 42, 43))

[State 50, 4]
type = AfterImage
trigger1 = Time = 0 && Var(5) && Vel X != 0
time = 30
trans = add1
timegap = 1
framegap = 2
length = 8
palbright = 12,12,12
palcontrast = 225,225,225
palpostbright = 0,0,0
paladd = 0,0,0
palmul = 1,1,1

;---------------------------------------------------------------------------
; Salto corto
[Statedef 950]
type = A
movetype = I
physics = A
anim = 41

[State 950, 1]
type = VelSet
trigger1 = Time = 0
x = IfElse(vel x = 0,0,IfElse(vel x < 0,-3.1,3.4))
y = -6.5

[State 950, 2]
type = VelSet
trigger1 = Time = 0 && Var(5)
x = IfElse(vel x = 0,0,IfElse(vel x < 0,-5,5))


[State 250, AfterImages]
type = AfterImage
trigger1 = Time = 0 && Var(5) && Vel X != 0
time = 20
trans = add1
TimeGap  = 2
FrameGap = 1
length = 3
PalBright   =   0,  0,  0
PalContrast = 128,128,128
PalAdd      =   0,  0,  0
PalMul      =   1,  1,  1

[State 950, 4]
type = ChangeState
trigger1 = Pos Y >= 0 && Vel Y > 0
value = 52

;----------------------------------------------------------------------

; Salto cayendo
[Statedef 51]
type    = A
physics = A

[State 51, 1]
type = Null
trigger1 = 1

;---------------------------------------------------------------------------
; Salto aterrizar
[Statedef 52]
type    = S
physics = S
ctrl = 0
anim = 47


[State 52, 1]
type = VelSet
trigger1 = Time = 0
y = 0

[State 52, 2]
type = PosSet
trigger1 = Time = 0
y = 0

[State 52, 3]
type = CtrlSet
trigger1 = Time = 3
value = 1

[State 52, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;------------------------------------------------------------------------------------

;teleporte adelante
[Statedef 100]
type    = A                      
movetype= A                      
physics = N                      
juggle  = 1                      
velset = 0,0                 
ctrl = 0                     
anim = 100                
poweradd = 0

;sonido teleporte
[State 100, 1]
type = PlaySnd
trigger1 = AnimElem = 4
value = 100,1

[State 250, 4]
type = VelSet
trigger1 = AnimElem = 2
x = 4
y = 0


[State 250, 4]
type = VelSet
trigger1 = AnimElem = 5
x = 0
y = 0

[State 100, 2]
type = posadd
trigger1 =  animelem = 5
x = 300  

[State 100,3]
type = ChangeState
trigger1 = time = 20
trigger1 = Pos Y  < 0
value = 1500
ctrl = 1

[State 100,4 ]
type = ChangeState
trigger1 = time = 20
value = 0
ctrl = 1

;teleporte atras
[Statedef 105]
type    = A                      
movetype= A                      
physics = N                      
juggle  = 1                      
velset = 0,0                 
ctrl = 0                     
anim = 105                  
poweradd = 0

[State 250, 4]
type = VelSet
trigger1 = AnimElem = 1
x = -4
y = 0

[State 250, 4]
type = VelSet
trigger1 = AnimElem = 4
x = 0
y = 0

;sonido teleporte
[State 105,1]
type = PlaySnd
trigger1 = AnimElem = 3
value = 100,1

[State 105,2]
type = posadd
trigger1 = animelem = 4
x =  - 300  

[State 105,3]
type = ChangeState
trigger1 = time = 15
trigger1 = Pos Y  < 0
value = 1500
ctrl = 1

[State 105,4 ]
type = ChangeState
trigger1 = time = 15
value = 0
ctrl = 1
;--------------------------------------------------------




; HITG_SHAKE
[Statedef 5000]
type    = S
movetype= H
physics = N
velset = 0,0

[State 5000, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(groundtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5000, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5000, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5000, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5000, 5] ;State type gets set to aerial if getting hit up
type = StateTypeSet
trigger1 = Time = 0
trigger1 = GetHitVar(yvel) != 0 && GetHitVar(fall)
trigger2 = Pos Y != 0
type = a

[State 5000, 6]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5001 ;HITG_SLIDE

[State 5000, 7]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5000, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5000, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5000, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
persistent = 0
time = 15
waveform = sinesquare
ampl = 140



;---------------------------------------------------------------------------
; HITG_SLIDE
[Statedef 5001]
type    = S
movetype= H
physics = S

[State 5001, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5001, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5005 + GetHitVar(animtype) + (GetHitVar(groundtype)=2)*10

[State 5001, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5001, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5001, 5]
type = DefenceMulSet
trigger1 = HitOver
value = 1


[State 5001, 6]
type = ChangeState
trigger1 = HitOver
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HITC_SHAKE
[Statedef 5010]
type    = C
movetype= H
physics = N
velset = 0,0

[State 5010, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = 5020 + GetHitVar(animtype)

[State 5010, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5010, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5010, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5010, 5]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5011 ;HITC_SLIDE

[State 5010, 6]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5010, FFB Light]
type = ForceFeedback
trigger1 = anim = 5020
persistent = 0
time = 6
waveform = square

[State 5010, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5021
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5010, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5022
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITC_SLIDE
[Statedef 5011]
type    = C
movetype= H
physics = C

[State 5011, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5011, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
value = 5025 + GetHitVar(animtype)

[State 5011, 3] ;Stop sliding back
type = VelMul
trigger1 = Time >= GetHitVar(slidetime)
x = .6

[State 5011, 4]
type = VelSet
trigger1 = HitOver
x = 0

[State 5011, 5]
type = DefenceMulSet
trigger1 = HitOver
value = 1

[State 5011, 6]
type = ChangeState
trigger1 = HitOver
value = 11
ctrl = 1


;---------------------------------------------------------------------------
; HITA_SHAKE
[Statedef 5020]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5020, 1] ;Anim for HIT_LIGHT to HIT_HARD
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) != [3,5]
value = ifelse((GetHitVar(airtype) = 1),5000,5010) + GetHitVar(animtype)

[State 5020, 2] ;Anim for HIT_BACK
type = ChangeAnim
trigger1 = Time = 0
trigger1 = GetHitVar(animtype) = [3,5]
value = 5030

[State 5020, 3] ;Anim for HIT_UP/HIT_DIAGUP (only if it exists)
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (GetHitVar(animtype) = [4,5]) && (SelfAnimExist(5047 + GetHitVar(animtype)))
value = 5047 + GetHitVar(animtype) ;5051 - 4 + type

[State 5020, 4] ;Freeze anim
type = ChangeAnim
trigger1 = Time > 0
value = anim

[State 5020, 5]
type = ChangeState
trigger1 = HitShakeOver
value = 5030

[State 5020, FFB Light]
type = ForceFeedback
trigger1 = anim = 5000
trigger2 = anim = 5010
persistent = 0
time = 6
waveform = square

[State 5020, FFB Medium]
type = ForceFeedback
trigger1 = anim = 5001
trigger2 = anim = 5011
persistent = 0
time = 8
waveform = sinesquare
ampl = 110,-1,-.3

[State 5020, FFB Hard]
type = ForceFeedback
trigger1 = anim = 5012
trigger2 = anim = 5002
trigger3 = anim = 5030
trigger4 = anim = [5051,5059]
persistent = 0
time = 15
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HITA_UP (initial going up)
[Statedef 5030]
type    = A
movetype= H
physics = N
ctrl = 0

[State 5030, 1]
type = VelAdd;Gravity
trigger1 = 1
y = GetHitVar(yaccel)

[State 5030, 2]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5030, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 5040 ;HITA_RECOV

[State 5030, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver
trigger2 = Vel Y > 0    ;Hit ground
trigger2 = Pos Y >= 10  ;.
value = 5050 ;HITA_FALL

[State 5030, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 5035 ;HITA_UP (transition)

;---------------------------------------------------------------------------
; HITA_UP_T (transition)
[Statedef 5035]
type    = A
movetype= H
physics = N

[State 5035, 1]
type = ChangeAnim
trigger1 = Time = 0
trigger1 = SelfAnimExist(5035)
trigger1 = Anim != [5051,5059] ;Not if in hit up anim
trigger1 = Anim != 5090 ;Not if hit off ground anim
value = 5035

[State 5035, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5035, 3]
type = ChangeState
triggerall = !HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Animation over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5040 ;HITA_RECOV

[State 5035, Air]
type = ChangeState
trigger1 = Var(3) != 0
value = 1500

[State 5035, 4]
type = ChangeState
triggerall = HitFall
trigger1 = HitOver  ;Hit is over
trigger2 = AnimTime = 0 ;Anim is over
trigger3 = Vel Y > 0    ;Hit ground
trigger3 = Pos Y >= 10  ;.
trigger4 = Time = 0     ;No transition anim
trigger4 = Anim != 5035 ;.
value = 5050 ;HITA_FALL

;---------------------------------------------------------------------------
; HITA_RECOV (recovering in air, not falling)
[Statedef 5040]
type    = A
movetype= H
physics = N

[State 5040, 1]
type = ChangeState
trigger1 = !Alive
value = 5050

[State 5040, 2]
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim != 5040
trigger2 = Time = 0
trigger2 = Anim != 5035
value = 5040

[State 5040, 3]
type = CtrlSet
trigger1 = HitOver
value = 1

[State 5040, 4]
type = StateTypeSet
trigger1 = HitOver
movetype = I

[State 5040, 5]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5040, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMPLAND

;---------------------------------------------------------------------------
; HITA_FALL (knocked up, falling)
[Statedef 5050]
type    = A
movetype= H
physics = N

[State 5050, 1] ;Change anim when done with transition
type = ChangeAnim
trigger1 = AnimTime = 0
trigger1 = Anim = 5035
trigger2 = Time = 0     ;If no transition anim
trigger2 = Anim != 5035
trigger2 = (Anim != [5051, 5059]) && (Anim != [5061, 5069])
trigger2 = Anim != 5090 ;Not if hit off ground anim
value = 5050

[State 5050, 2] ;Coming down anim
type = ChangeAnim
trigger1 = anim = [5050,5059]
trigger1 = Vel Y >= ifelse(anim = 5050, 1, -2)
trigger1 = SelfAnimExist(anim+10)
value = anim+10
persistent = 0

[State 5050, 3] ;Gravity
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5050, 4] ;Recover near ground
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 5050, 5]; Recover in mid air
type = ChangeState
triggerall = Vel Y > -1
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 5050, 6]
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= ifelse((anim = [5051,5059]) || (anim = [5061,5069]), 0, 25)
value = 5100 ;HIT_BOUNCE

;---------------------------------------------------------------------------
; HIT_TRIP (shaking)
[Statedef 5070]
type    = A
movetype= H
physics = N
velset = 0,0

[State 5070, Argh!]
type = PlaySnd
trigger1 = Time = 2
value = 0, 3
volume = 255

[State 5070, Air]
type = ChangeState
trigger1 = Var(3) != 0
trigger1 = HitShakeOver
value = 1500

[State 5070, 1]
type = ChangeAnim 
trigger1 = 1
value = 5070

[State 5070, 2]
type = ChangeState
trigger1 = HitShakeOver
value = 5071

[State 5070, 3]
type = ForceFeedback
trigger1 = time = 0
time = 12
waveform = sinesquare
ampl = 140

;---------------------------------------------------------------------------
; HIT_TRIP2 (fall through air)
[Statedef 5071]
type    = A
movetype= H
physics = N

[State 5071, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1
y = 1

[State 5071, 2] ;Acceleration
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5071, 3] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 15
type = ChangeState
value = 5110

;---------------------------------------------------------------------------
; HITL_SHAKE
[Statedef 5080]
type    = L
movetype= H
physics = N
velset = 0,0

[State 5080, 1] ;Set default anim
type = VarSet
trigger1 = time = 0
sysvar(2) = ifelse (GetHitVar(yvel) = 0, 5080, 5090)

[State 5080, 2]
type = VarAdd
trigger1 = time = 0
trigger1 = (anim = [5081,5089]) || (anim = [5111,5119])
trigger1 = SelfAnimExist(sysvar(2) + (anim % 10))
sysvar(2) = anim % 10

[State 5080, 3] ;If 5090 doesn't exist, default to 5030
type = VarSet
trigger1 = time = 0
trigger1 = sysvar(2) = 5090
trigger1 = !SelfAnimExist(5090)
sysvar(2) = 5030

[State 5080, 3] ;Freeze
type = ChangeAnim
trigger1 = 1
value = sysvar(2)

[State 5080, 4]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) = 0
value = 5081 ;HITL_SLIDE

[State 5080, 5]
type = ChangeState
trigger1 = HitShakeOver
trigger1 = GetHitVar(yvel) != 0
value = 5030 ;HITA_UP

;---------------------------------------------------------------------------
; HITL_SLIDE
[Statedef 5081]
type    = L
movetype= H
physics = C

[State 5081, 1]
type = HitVelSet
trigger1 = Time = 0
x = 1

[State 5081, 2]
type = VelSet
trigger1 = HitOver
x = 0

[State 5081, 3] ;Don't show hit ground frame
type = VarSet
trigger1 = Time = 0
sysvar(0) = 1

[State 5081, 4]
type = ChangeState
trigger1 = HitOver
value = 5110 ;HIT_LIEDOWN

;---------------------------------------------------------------------------
; HIT_BOUNCE (hit ground)
[Statedef 5100]
type    = L
movetype= H
physics = N

[State 5100, 1]
type = VelSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
trigger1 = vel x > 1
x = 1

[State 5100, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5100, Var] ;Save fall velocity
type = VarSet
trigger1 = Time = 0
;trigger1 = GetHitVar(fall.yvel) = 0
sysvar(1) = floor(vel y)

[State 5100, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = (anim != [5051,5059]) && (anim != [5061,5069])
trigger2 = !SelfAnimExist(5100 + (anim % 10))
value = 5100

[State 5100, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
trigger1 = time = 0
trigger1 = (anim = [5051,5059]) || (anim = [5061,5069])
trigger1 = SelfAnimExist(5100 + (anim % 10))
value = 5100 + (anim % 10)

[State 5100, 4]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5100, 5]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5100, 6] ;Reduce speed
type = VelMul
trigger1 = Time = 0
x = 0.75

[State 5100, 7]
type = ChangeState
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) = 0
value = 5110 ;HIT_LIEDOWN

[State 5100, 8]
type = GameMakeAnim
trigger1 = Time = 1
;value = 61
;pos = 0, 0
;under = 1
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 5100, 9]
type = HitFallDamage
trigger1 = Time = 3

[State 5100, 10]
type = PlaySnd
trigger1 = Time = 1
;value = F7, 0 ;Hit ground
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5100, 11]
type = PosFreeze
trigger1 = 1

[State 5100, 12]
type = ChangeState
trigger1 = AnimTime = 0
value = 5101

[State 5100, 13]
type = ForceFeedback
trigger1 = Time = 0
waveform = sinesquare
ampl = 128,-3,-.2,.005
time = 20

;---------------------------------------------------------------------------
; HIT_BOUNCE (bounce into air)
[Statedef 5101]
type    = L
movetype= H
physics = N

[State 5101, 1] ;Coming hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5101,5109]
trigger2 = !SelfAnimExist(5160 + (anim % 10))
value = 5160

[State 5101, 2] ;Coming hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5101,5109]
trigger1 = SelfAnimExist(5160 + (anim % 10))
value = 5160 + (anim % 10)

[State 5101, 3]
type = HitFallVel
trigger1 = Time = 0

[State 5101, 4]
type = PosSet
trigger1 = Time = 0
y = 20

[State 5101, 5] ;Acceleration
type = VelAdd
trigger1 = 1
y = .4

[State 5101, 6] ;Hit ground
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 12
type = ChangeState
value = 5110

;---------------------------------------------------------------------------
; HIT_LIEDOWN
[Statedef 5110]
type    = L
movetype= H
physics = N

[State 5110, EnvShake]
type = FallEnvShake
trigger1 = Time = 0

[State 5110, 1] ;For hit up/up-diag type (from state 5081)
type = ChangeAnim
persistent = 0
trigger1 = SelfAnimExist(5110 + (anim % 10))
trigger1 = anim = [5081,5089]
value = 5110 + (anim % 10)

[State 5110, 2] ;Hit ground anim (normal)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim != [5161,5169]
trigger2 = !SelfAnimExist(5170 + (anim % 10))
value = 5170

[State 5110, 3] ;Hit ground anim (for hit up)
type = ChangeAnim
triggerall = time = 0
triggerall = anim != [5110,5119] ;Not already changed anim
trigger1 = anim = [5161,5169]
trigger1 = SelfAnimExist(5170 + (anim % 10))
value = 5170 + (anim % 10)

[State 5110, 4]
type = HitFallDamage
trigger1 = Time = 0

[State 5110, 5]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5110, Var] ;Get fall velocity
type = VarSet
trigger1 = Time = 0
trigger1 = GetHitVar(fall.yvel) != 0
sysvar(1) = floor(vel y)

[State 5110, 6]
type = PlaySnd
trigger1 = Time = 0
trigger1 = !SysVar(0)
;value = F7, 0 ;Hit ground
value = F7, (sysvar(1) > 5) + (sysvar(1) > 14)

[State 5110, 7]
type = GameMakeAnim
trigger1 = Time = 0
trigger1 = !SysVar(0)
value = 60 + (sysvar(1) > 5) + (sysvar(1) > 14)
pos = 0, 0
under = sysvar(1) <= 10

[State 5110, 8]
type = VelSet
trigger1 = Time = 0
y = 0

[State 5110, 9] ;For hit up type
type = ChangeAnim
persistent = 0
triggerall = anim = [5171,5179]
triggerall = SelfAnimExist(5110 + (anim % 10))
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground anim
value = 5110 + (anim % 10)

[State 5110, 10] ;For normal
type = ChangeAnim
persistent = 0
triggerall = Anim != [5111,5119]
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
value = 5110

[State 5110, 11] ;If just died
type = ChangeState
triggerall = !alive
trigger1 = AnimTime = 0
trigger2 = SysVar(0) ;SysVar(0) = 1 avoids hit ground frame
trigger3 = Anim = [5110,5119]
value = 5150

[State 5110, 12]
type = VarSet
trigger1 = SysVar(0)
trigger1 = Time = 0
sysvar(0) = 0

[State 5110, 13] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5110, 14]
type = ForceFeedback
trigger1 = alive
trigger1 = Time = 0
time = 8
ampl = 240
waveform = sine

[State 5110, 15]
type = ForceFeedback
trigger1 = !alive
trigger1 = Time = 0
ampl = 200, 7, -.467
time = 30
waveform = sine

;---------------------------------------------------------------------------
; HIT_GETUP
[Statedef 5120]
type    = L
movetype= I
physics = N

[State 5120, 1a] ;Get up anim (normal)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim != [5111,5119]
trigger2 = !SelfAnimExist(5120 + (anim % 10))
value = 5120

[State 5120, 1b] ;Get up anim (for hit up/diag-up)
type = ChangeAnim
triggerall = time = 0
trigger1 = anim = [5111,5119]
trigger1 = SelfAnimExist(5120 + (anim % 10))
value = 5120 + (anim % 10)

[State 5120, 2]
type = VelSet
trigger1 = Time = 0
x = 0

[State 5120, 3]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5120, 4]
type = HitFallSet
trigger1 = AnimTime = 0
value = 1

[State 5120, 5] ;Can't be thrown right after getting up
type = NotHitBy
trigger1 = AnimTime = 0
value = , NT,ST,HT
time = 12

[State 5120, 6] ;Can't be hit right after getting up (short time)
type = NotHitBy
trigger1 = AnimTime = 0
value2 = SCA
time = 3

[State 5120, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; HIT_LIEDEAD
[Statedef 5150]
type    = L
movetype= H
physics = N
sprpriority = -3

[State 5150, 1] ;Normal anim
type = ChangeAnim
triggerall = Time = 0
triggerall = SelfAnimExist(5140)
trigger1 = (anim != [5111,5119]) && (anim != [5171,5179])
trigger2 = !SelfAnimExist(5140 + (anim % 10))
value = 5140

[State 5150, 3] ;Hit up type anim
type = ChangeAnim
trigger1 = Time = 0
trigger1 = (anim = [5111,5119]) || (anim = [5171,5179])
trigger1 = SelfAnimExist(5140 + (anim % 10))
value = 5140 + (anim % 10)

[State 5150, 4] ;Match over anim
type = ChangeAnim
persistent = 0
;trigger1 = Time = 0
trigger1 = MatchOver = 1
trigger1 = Anim = [5140,5149]
trigger1 = SelfAnimExist(anim+10)
value = anim+10

[State 5150, 5] ;Switch to 5110 if liedead anim does not exist
type = ChangeAnim
trigger1 = Time = 0
trigger1 = Anim != [5140,5159]
trigger1 = Anim != [5110,5119]
value = 5110

[State 5150, 6] ;Friction
type = VelMul
trigger1 = 1
x = 0.85

[State 5150, 7] ;Friction
type = VelSet
trigger1 = Vel x < .05
persistent = 0
x = 0

[State 5150, 8]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;---------------------------------------------------------------------------
; HIT_FALLRECOVER (still falling)
[Statedef 5200]
type    = A
movetype= H
physics = N

[State 5200, 1] ;Change anim if done with transition
type = ChangeAnim
trigger1 = Anim = 5035
trigger1 = AnimTime = 0
value = 5050

[State 5200, 2]
type = VelAdd
trigger1 = 1
y = GetHitVar(yaccel)

[State 5200, 3]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 10
value = 5201

;---------------------------------------------------------------------------
; HIT_FALLRECOVER (on the ground)
[Statedef 5201]
type    = A
movetype= H
physics = A
anim = 5200

[State 5201, 1] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -5

[State 5201, 2]
type = VelSet
trigger1 = Time = 0
x = -.15
y = -3.5

[State 5201, 3]
type = PosSet
trigger1 = Time = 0
y = 0

[State 5201, 4]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 5201, 5] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5201, 6]
type = GameMakeAnim
trigger1 = Time = 1
value = 60
pos = 0, 0
under = 1

;---------------------------------------------------------------------------
; HIT_AIRFALLRECOVER
[Statedef 5210]
type    = A
movetype= I
physics = N
anim = 5210
ctrl = 0

[State 5210, 1] ;Blink white
type = PalFX
trigger1 = Time = 0
time = 3
add = 128,128,128 ;256,256,256

[State 5210, 1]
type = PosFreeze
trigger1 = Time = 0
value = 4

[State 5210, 2] ;Turn if not facing opponent
type = Turn
trigger1 = Time = 0
trigger1 = p2dist X < -20

[State 5210, 1] 
type = VelMul
trigger1 = Time = 4
x = .8
y = .8

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
y = -4.5

[State 5210, 1] 
type = VelMul
trigger1 = Time = 4
trigger1 = Vel Y > 0
y = .5

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -3
y = -2

[State 5210, 1]
type = VelAdd
trigger1 = Time = 4
trigger1 = Vel Y > -2
y = -1

[State 5210, 2] ;Go up
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holdup"
y = -2

[State 5210, 2] ;Go down
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holddown"
y = 1.5

[State 5210, 2] ;Go fwd
type = VelMul
trigger1 = Time = 4
trigger1 = Command = "holdfwd"
x = 1

[State 5210, 2] ;Go back
type = VelAdd
trigger1 = Time = 4
trigger1 = Command = "holdback"
x = -1

[State 5210, 3]
type = NotHitBy
trigger1 = Time = 0
value = SCA
time = 15

[State 5210, 4]
type = CtrlSet
trigger1 = Time = 20
value = 1

[State 5210, 5]
type = VelAdd;Gravity
trigger1 = Time >= 4
y = .35

[State 5210, 5] ;Land on ground
type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52 ;JUMP_LAND
ctrl = 1

; Continue?
[Statedef 5500]
type = S
ctrl = 0
anim = 5300
velset = 0,0

[State 5500, 1] ;Use continue animation if available
type = ChangeAnim
trigger1 = time = 0
trigger1 = SelfAnimExist(5500)
value = 5500

;---------------------------------------------------------------------------
; Initialize (at the start of the round)
[Statedef 5900]
type = S

[State 5900, 1] ;Clear all int variables
type = VarRangeSet
trigger1 = roundno = 1
value = 0

[State 5900, 2] ;Clear all float variables
type = VarRangeSet
trigger1 = roundno = 1
fvalue = 0

[State 5900, 3] ;Intro
type = ChangeState
trigger1 = roundno = 1
value = 190

;--------------------------------------------------
;Perder en tiempo fuera 
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1
;---------------------------------------------------------------------------
;estado de decidir Win
[Statedef 180]
type = S

[State 180, 1]
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
; posicion de Win
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 181, 1]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;-------------------------------------------------------------
; INTRO
[Statedef 190]

[State 190, 3]
type = ChangeState
trigger1 = random <= 449
value = 191

;[State 190, 3]
;type = ChangeState
;trigger1 = random <= 449
;value = 192


;---------------------------------------------------------------------------
; Introduccion
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

[State 191, 0]
type = bgpalfx
trigger1 = AnimElem = 22
time = 50
sinadd = 235,235,235,100

[State 191,3]
type = Envshake
trigger1 = animelem = 1
time = 80
ampl = 3
freq = 300

[State 191,aura 1]
type = Explod
trigger1 = animelem = 20
persistent = 0
anim = 191
postype = p1
pos = 0, 0
ontop = 1
;velocity = -4.2, -7
;accel = 0, .32
removetime = 79

[State 191,aura 2]
type = Explod
trigger1 = animelem = 21
persistent = 0
anim = 192
postype = p1
pos = 0, 0
ontop = 1
;velocity = -4.2, -7
;accel = 0, .32
removetime = 30

[State 191, 4]
type = Envcolor
trigger1 = animelem = 20
time = 5

[Statedef 192]
type = S
ctrl = 0
anim = 193
velset = 0,0

[State 191, 1] ;Freeze animation until PreIntro is over
type = ChangeAnim
trigger1 = RoundState = 0
value = 193

[State 191, 2] ;Assert this until you want "round 1, fight" to begin
type = AssertSpecial
trigger1 = 1
flag = Intro

[State 191, 3] ;Change to stand state when done
type = ChangeState
trigger1 = AnimTime = 0
value = 0

[State 191,aura 2]
type = Explod
trigger1 = animelem = 9
persistent = 0
anim = 194
postype = p1
pos = -35, 0
ontop = 1
;velocity = -4.2, -7
;accel = 0, .32
removetime = 100

;---------------------------------------------------------------------------
; Saludo
[Statedef 195]
type = S
ctrl = 0
anim = 195
velset = 0,0
movetype = I
physics = S
sprpriority = 2

[State 195, 1]
type = CtrlSet
trigger1 = Time = 40
value = 1

[State 195, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------------------------
; Stand Puño bajo
[Statedef 200]
type    = S                      
movetype= A                      
physics = S                      
juggle  = 1                 
velset = 0,0                     
ctrl = 0                         
anim = 200                       
poweradd = 20                    
sprpriority = 2  
                
[State 200, 1]
type = HitDef
trigger1 = animelem = 2
attr = S, NA                     
damage = 23, 0                   
animtype = Light                 
guardflag = MA                   
hitflag = MAF                    
priority = 3              
pausetime = 8,8               
sparkno =  s9002                  
sparkxy = -10, -56               
hitsound = S748, 1                 
guardsound = 6, 0                
ground.type = High               
ground.slidetime = 5             
ground.hittime  = 25            
ground.velocity = -4             
airguard.velocity = -1.9,-.8     
air.type = High                  
air.velocity = -1.4,-3           
air.hittime = 12                 

[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 746, 0


[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 1

[State 200]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500

[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;----------------------------------------------------------------------------------------------------------------
; Stand Light Punch 2
[Statedef 201]
type    = S                      
movetype= A                      
physics = S                      
juggle  = 1                      
velset = 0,0                     
ctrl = 0                         
anim = 201                       
poweradd = 20                    
sprpriority = 2                  

[State 20, 3]
type = veladd
trigger1 = animelem = 4
x = 6

[State 200, 1]
type = HitDef
trigger1 = AnimElem = 5
attr = S, NA                     
damage = 23, 0                   
animtype = Light                 
guardflag = MA                   
hitflag = MAF                    
priority = 3, Hit                
;Hit/Miss/Dodge type (Def: Hit)
pausetime = 8, 8                 
sparkno = s9002                    
sparkxy = -10, -56               
;Y-offset for the spark rel. to p1
hitsound = S748, 1                 
guardsound = 6, 0                
ground.type = High               
ground.slidetime = 5             
ground.hittime  = 10             
ground.velocity = -4             
airguard.velocity = -1.9,-.8     
air.type = High                  
air.velocity = -1.4,-3           
air.hittime = 12                 

[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 746, 0

[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 1

[State 200]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500


[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------------------------------------------------
; puño volador 
[Statedef 202]
type    = S                      
movetype= A                      
physics = S                      
juggle  = 1                      
velset = 0,0                     
ctrl = 0                         
anim = 814                       
poweradd = 20                    
sprpriority = 2                  

[State 250, AfterImages]
type = AfterImage
trigger1 = AnimElem = 2
time = 30
trans = add1
TimeGap  = 2
FrameGap = 1
length = 3
PalBright   =   0,  0,  0
PalContrast = 128,128,128
PalAdd      =   0,  0,  0
PalMul      =   1,  1,  1



[State 738, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA
time = 30


[State 2200, 2]
type = VelSet
trigger1 = time >= 0
trigger1 = time <= 10
x = 7
y = -2


[State 2200, 3]
type = VelSet
trigger1 = time >= 10
trigger1 = time <= 20
x = 7
y = 2

[State 200, 3]
type = VelSet
trigger1 = time >= 20
x = 0
y = 0

[State 200, 3]
type = HitDef
trigger1 = time=0 
attr = S,NA
hitflag = MAF
guardflag =MA 
animtype = Hard
air.animtype = Back
fall.animtype = Back
damage = 30,4
pausetime = 5,10
ground.type = high
ground.velocity = -5,-6
air.velocity = -1, -7
ground.slidetime =10
ground.hittime = 12
sparkxy = 0,-80
sparkno = 1
guard.sparkno = 1
fall =1
hitsound= S748, 1   


[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 746, 0


[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 1

[State 200]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500


[State 200, 7]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;----------------------------------------------------------------------------------------------------------------
[Statedef 210]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 65
ctrl = 0
velset = 0,0
anim = 210
sprpriority = -1

[State 210, Width]
type = Width
trigger1 = (AnimElemTime (2) >= 0) && (AnimElemTime (7) < 0)
value = 15,0

[State 210, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 4

[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 2

[State 210, 2]
type = HitDef
trigger1 = AnimElem = 2
attr = S, NA
animtype  = Medium
damage    = 57
guardflag = MA
pausetime = 12,12
sparkno = s9002
sparkxy = -10,-50
hitsound   = S748,2
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 13
ground.velocity = -5.5
air.velocity = -2.5,-4

[State 210, 3]
type = ChangeAnim
trigger1 = AnimElemTime(5) > 0 && AnimElemTime(6) <= 0
trigger1 = movecontact
ignorehitpause = 1
persistent = 0
value = 210
elem = 6

[State 210, 4]
type = SprPriority
trigger1 = AnimElem = 5
value = 2

[State 210]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500

[State 210, 5]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing light kick
; CNS difficulty: easy
[Statedef 230]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 22
ctrl = 0
velset = 0,0
anim = 230
sprpriority = 2

[State 230, 1]
type = PlaySnd
trigger1 = Time = 2
value = 747, 0


[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 3

[State 230, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 26
guardflag = MA
pausetime = 12,12
sparkno = s9002
sparkxy = -10,-37
hitsound   = S748,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 10
ground.hittime  = 11
ground.velocity = -5
air.velocity = -2.5,-3.5

[State 230]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500



[State 230, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
; Standing strong kick
; CNS difficulty: easy
[Statedef 240]
type    = S
movetype= A
physics = S
juggle  = 5
poweradd= 65
ctrl = 0
velset = 0,0
anim = 240
sprpriority = 2

[State 240, 1]
type = PlaySnd
trigger1 = Time = 2
value = 748, 0


[State 200, 1]
type = PlaySnd
trigger1 = Time = 1
value = 200, 3

[State 240, 2]
type = HitDef
trigger1 = Time = 0
attr = S, NA
animtype  = Medium
damage    = 63
guardflag = MA
pausetime = 12,12
sparkno = s9002
sparkxy = -10,-60
hitsound   = S748,4
guardsound = 6,0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -6
air.velocity = -2.2,-3.2

[State 240, 3]
type = PosAdd
trigger1 = AnimElem = 7
x = 12

[State 240]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500



[State 240, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;------------------------------------------------------------------
; patada invertida
[Statedef 250]
type    = S
movetype= A
physics = S
juggle  = 5
poweradd= 65
ctrl = 0
velset = 15,0
anim = 813
sprpriority = 5

[State 738, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA
time = 40

[State 250, AfterImages]
type = AfterImage
trigger1 = AnimElem = 1
time = 30
trans = add1
TimeGap  = 2
FrameGap = 1
length = 3
PalBright   =   0,  0,  0
PalContrast = 128,128,128
PalAdd      =   0,  0,  0
PalMul      =   1,  1,  1

[State 250, 1]
type = PlaySnd
trigger1 = Time = 1
value = 742,0

[State 250, primer golpe]
type = HitDef
trigger1 = animelem = 3
attr = S, NA
animtype  = Light
getpower = 70,35
givepower = 40,20
damage    = 50,10
hitflag = MAF
guardflag = MA
priority = 4, Hit
pausetime = 7,7
sparkno = s9002
guard.sparkno = -1
sparkxy = -10,-35   
hitsound   = S748,4
guardsound = S1,7
ground.type = Low
ground.slidetime = 5
ground.hittime  = 10
ground.velocity = -5    
air.velocity = -5,-2


[State 250, segundo golpe]
type = HitDef
trigger1 = animelem = 4
attr = S, NA
animtype  = Light
getpower = 70,35
givepower = 40,20
damage    = 50,10
hitflag = MAF
guardflag = MA
priority = 4, Hit
pausetime = 7,7
sparkno = s9002
guard.sparkno = -1
sparkxy = -10,-35   
hitsound   = S748,4
guardsound = S1,7
ground.type = Low
ground.slidetime = 5
ground.hittime  = 10
ground.velocity = -5    
air.velocity = -5,-2

[State 250, 2]
type = VelSet
trigger1 = time >= 0
trigger1 = time <= 10
x = 5
y = -4

[State 250, 3]
type = VelSet
trigger1 = time >= 10
trigger1 = time <= 20
x = 5
y = 4

[State 250, 4]
type = VelSet
trigger1 = AnimElem = 5
x = 0
y = 0

[State 210]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500

[State 250, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Puño bajo agachado 
[Statedef 400,Puño bajo agachado ]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 15
ctrl = 0
anim = 400
sprpriority = 2

[State 400, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 400, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 23
priority  = 3
animtype  = Light
hitflag = MAF
guardflag = L
pausetime = 10,11
sparkno = s9002
sparkxy = -10,-42
hitsound   = S748,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 4
ground.hittime  = 10
ground.velocity = -4
air.velocity = -1.5,-3

[State 400, 4]
type = CtrlSet
trigger1 = Time = 15
value = 1

[State 400, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11

;---------------------------------------------------------------------------
;Crouching strong punch
[Statedef 410]
type    = C
movetype= A
physics = C
juggle  = 6
poweradd= 50
ctrl = 0
anim = 410
sprpriority = 2

[State 410, 1]
type = PlaySnd
trigger1 = Time = 1
value = 747, 0

;This is the first hit, triggered on the 3rd element of animation.
[State 410, 2]
type = HitDef
trigger1 = AnimElem = 2
attr = C, NA
damage    = 37
animtype  = Medium
hitflag = MAF
guardflag = M
pausetime = 12,12
sparkno = s9002
sparkxy = -10,-55
hitsound   = S748,3
guardsound = 6,0
ground.type = Low
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -4
air.velocity = -3,-4

;This is the second hit, triggered on the 4th element of animation.
[State 410, 3]
type = HitDef
trigger1 = AnimElem = 4
attr = C, NA
damage    = 36
animtype  = Medium
hitflag = MAF
guardflag = MA
pausetime = 12,12
sparkxy = -10,-83
hitsound   = 5,2
guardsound = 6,0
ground.type = High
ground.slidetime = 12
ground.hittime  = 15
ground.velocity = -7
air.velocity = -3,-4

[State 410, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouching light kick
; CNS difficulty: easy
[Statedef 430]
type    = C
movetype= A
physics = C
juggle  = 5
poweradd= 22
ctrl = 0
anim = 430
sprpriority = 2

[State 430, 1]
type = PlaySnd
trigger1 = Time = 1
value = 746, 0

[State 20, 3]
type = veladd
trigger1 = animelem = 2
x = 6



[State 430, 2]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 28
animtype  = Light
hitflag = MAFD
guardflag = L
pausetime = 12,12
sparkno = s9002
sparkxy = -10,-8
hitsound   = S748,2
guardsound = 6,0
ground.type = Low
ground.slidetime = 6
ground.hittime  = 10
ground.velocity = -5
air.velocity = -2,-3
down.velocity = -5,0
down.hittime = 20

[State 430, 3]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Crouch Strong Kick
; CNS difficulty: easy
; Description: This move uses "Trip" for the "ground.type" parameter in
;     its HitDef. It's a special type that puts the opponent in a tripped
;     animation as he falls. Also, the hitflag parameter in the HitDef
;     is set to "MAFD". The "D" indicates that a downed opponent can be
;     hit by the attack.
; CNS ƒŒƒxƒ‹: ˆÕ
; Ú×:
[Statedef 440]
type    = C
movetype= A
physics = C
juggle  = 7
poweradd= 70
ctrl = 0
anim = 440
sprpriority = 2

[State 20, 3]
type = veladd
trigger1 = animelem = 2
x = 6


[State 440, 2]
type = PlaySnd
trigger1 = Time = 2
value = 746, 0

[State 440, 3]
type = HitDef
trigger1 = Time = 0
attr = C, NA
damage    = 72
hitflag = MAFD
guardflag = L
pausetime = 12,12
sparkno = s9002
sparkxy = -5,-10
hitsound   = S748,1
guardsound = 6,0
ground.type = Trip
ground.slidetime = 10
ground.hittime  = 15
ground.velocity = -1.5,-2
air.velocity = -1.2,-3
guard.velocity = -5
fall = 1

[State 440, 4]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;Jump Light Punch
; CNS difficulty: easy
[Statedef 600]
type    = A
movetype= A
physics = A
juggle  = 2
poweradd= 11
ctrl = 0
anim = 600
sprpriority = 2

[State 600, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 600, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 20
guardflag = HA
priority = 3
pausetime = 7,8
sparkno = 0
sparkxy = -10,-58
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 5
ground.hittime  = 5
ground.velocity = -4
air.velocity = -1.3,-3

[State 600, 3]
type = CtrlSet
trigger1 = Time = 17
value = 1

;---------------------------------------------------------------------------
;Jump Strong Punch
; CNS difficulty: easy
[Statedef 610]
type    = A
movetype= A
physics = A
juggle  = 4
poweradd= 65
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 610, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 72
guardflag = HA
priority = 4
pausetime = 12,12
sparkno = 1
sparkxy = -10,-55
hitsound   = 5,3
guardsound = 6,0
animtype = Med
ground.type = High
ground.slidetime = 17
ground.hittime  = 17
ground.velocity = -5
air.velocity = -3,-4

;---------------------------------------------------------------------------
;Jump Light Kick
; CNS difficulty: easy
[Statedef 630]
type    = A
movetype= A
physics = A
juggle  = 3
poweradd= 20
ctrl = 0
anim = 630
sprpriority = 2

[State 630, 1]
type = PlaySnd
trigger1 = Time = 1
value = 0, 0

[State 630, 2]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage = 26
guardflag = HA
priority = 3
pausetime = 8,8
sparkno = 1
sparkxy = -5,-35
hitsound   = 5,0
guardsound = 6,0
ground.type = High
ground.slidetime = 6
ground.hittime  = 6
ground.velocity = -4
air.velocity = -2,-3

;---------------------------------------------------------------------------
;Jump Strong Kick
; CNS difficulty: easy
[Statedef 640]
type    = A
movetype= A
physics = A
juggle  = 4
poweradd= 65
ctrl = 0
anim = 640
sprpriority = 2

[State 640, 2]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 640, 3]
type = HitDef
trigger1 = Time = 0
attr = A, NA
damage    = 70
guardflag = HA
priority = 4
pausetime = 12,12
sparkno = 1
sparkxy = -10,-40
hitsound   = 5,3
guardsound = 6,0
animtype = Med
ground.type = High
ground.slidetime = 15
ground.hittime  = 15
ground.velocity = -5
air.velocity = -3,-4

;---------------------------------------------------------------------------
; Cargar ki
[Statedef 730, 0]
type    = S
movetype= I
physics = S
juggle  = 9
velset = 0,0
ctrl = 0
anim = 730
poweradd = 0
facep2 = 1

;[State 191:		BGPalFX]
;type			= BGPalFX
;trigger1	      =((Time > 50) && ((GameTime%5) = 0))
;time			= 10
;add			= 20,20,20
;mul			= 256,256,256
;sinadd		= 200,200,200,4
;invertall		= 1
;color			= 256


;[State 730, 0]
;type = bgpalfx
;trigger1 = ((Time > 50) && ((GameTime%5) = 0))
;time = 50
;sinadd = 235,235,235,235

;flash blanco 
[State 730,1]
type = Envcolor
trigger1 = animelem = 2
time = 5


[State 730, terremoto]
type			= EnvShake
trigger1          =((Time > 50) && ((GameTime%5) = 0))
time			= 5
freq			= 140
ampl			= -4
phase			= 90

[State 730:	Rocas levantandose]
type			= Helper
trigger1		= Time > 50 
trigger1          = ((GameTime%10) = 0) 
trigger1          = Random < 249
helpertype		= Normal
name			= "Rocas"
id			= 733
pos			= 0,0
postype		= p1
facing		= 0
stateno		= 733
keyctrl		= 0
ownpal		= 1
supermovetime	= 0
pausemovetime	= 0


[State 730: humo izquierdo]
type = Explod
trigger1 = AnimElem = 2
anim = 9022
id = 9022
pos = -40,0
postype = p1
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
shadow = 0,0,0

[State 730: humo derecho]
type = Explod
trigger1 = AnimElem = 2
anim = 9022
id = 9022
pos = 40,0
postype = p1
facing = -1
bindtime = 1
removetime = -2
sprpriority = 3
shadow = 0,0,0

[State 730]
type = Playsnd
trigger1 = AnimElem = 2
value = 2000,0

[State 730]; sprites polvo
type  = Helper
trigger1 = time = 20 
helpertype = normal
ID = 732
pos = 0,0
stateno = 732
ownpal  = 1
size.xscale = 0.8
size.yscale = 0.8
ignorehitpause = 0
persistent = 0

[State 730, efecto suelo ]
type			= Explod
trigger1		= time = 20
anim			= 9003
id			= 9003
pos			= 0,0
postype		= p1
facing		= 1
vfacing		= 1
bindtime		= -1
vel			= 0,0
accel			= 0,0
random		= 0,0
removetime		= -1
supermove		= 0
supermovetime	= 0
pausemovetime	= 0
scale			= 0.7,0.7
sprpriority		= 0
ontop			= 0
shadow		= 0,0,0
ownpal		= 1
removeongethit	= 1


[State 730,	remover efecto suelo ]
type			= RemoveExplod
id			= 9003
trigger1		= (command != "charge") || (command != "charge 1") || (life = 0) || stateno != 730;(Time = 90)



[State 730, 1]
type = Poweradd
trigger1 = Time >= 0
value = 5

[State 730,grito ki ]
type = playsnd
trigger1 = animelem = 2
value = 740,0
channel = 1
volume = 255

[State 730,comienzo ki ]
type = PlaySnd
trigger1 = animelem = 1
value = 741,0
volume = 100
channel = 2

[State 730,terremoto ]
type = PlaySnd
trigger1 = animelem = 3
value = 748,10
volume = 210
channel = 7

[State 730, ki]
type = PlaySnd
trigger1 = Time = 0
value = 738,0
volume = 255

[State 730, PlaySND]
type = PlaySnd
triggerall = var(6) = 0
trigger1 = TimeMod = 20,0
value = S738
volume = 255
channel = 6

[State 730:	StopSnd]
type			= StopSnd
trigger1 = (command != "charge") || (command != "charge 1") || (life = 0) || stateno != 730
channel		= 6

[State 730:	StopSnd]
type			= StopSnd
trigger1 = (command != "charge") || (command != "charge 1") || (life = 0) || stateno != 730
channel		= 6


[State 730:	StopSnd]
type			= StopSnd
trigger1 = (command != "charge") || (command != "charge 1") || (life = 0) || stateno != 730
channel		= 1

[State 730:	StopSnd]
type			= StopSnd
trigger1 = (command != "charge") || (command != "charge 1") || (life = 0) || stateno != 730
channel		= 2

[State 730:	StopSnd]
type			= StopSnd
trigger1 = (command != "charge") || (command != "charge 1") || (life = 0) || stateno != 730
channel		= 7



[State 730]; sprites aura
type  = Helper
trigger1 = animelem = 2 
helpertype = normal
ID = 731
pos = 0,0
stateno = 731
ownpal  = 1
size.xscale = 0.6
size.yscale = 0.65
ignorehitpause = 0
persistent = 0

[State 0, Destroy]
type = ChangeState
trigger1 = (command != "charge") || (command != "charge 1")
value = 0
ctrl = 1

;-----------------------------------------------------------------------
; aura 
[Statedef 731]
type = S
movetype = I
physics = N
anim = 731
ctrl = 0
poweradd = 0
juggle = 0
sprpriority = 100


[State 731:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 1000000
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add

[State 730, Remover Aura]
type = destroySelf
trigger1 = (parent, stateno !=730)  && (parent, stateno !=731)
;value = 0
;ctrl = 1
;------------------------------------------------------------------------------------------
; efecto suelo 
[Statedef 732]
type = S
movetype = I
physics = N
anim = 9004
ctrl = 0
poweradd = 0
juggle = 0
sprpriority = 100


[State 732:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 1000000
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add

[State 732, Remover Aura]
type = destroySelf
trigger1 = (parent, stateno !=730)  && (parent, stateno !=731)
;value = 0
;ctrl = 1

;------------------------------------------------------------------------------------------
; rocas
[Statedef 733]
type = S
movetype = I
physics = N
anim = 9005
ctrl = 0
poweradd = 0
juggle = 0
sprpriority = 100

[State 733:	VarRandom]
type			= VarRandom
trigger1		= (!Time)
v			= 0
range			= -200,200

[State 733:	PosSet]
type			= PosSet
trigger1		= (!Time)
x			= var(0)
y			= 0

[State 733:	VelSet]
type			= VelSet
trigger1		= (Time = 1)
x			= (IfElse(Random <= 799,0,IfElse((Random = [800,900]),-0.2,0.2)))
y			= (IfElse(Random <= 499,-1,-2))

[State 733:	VelAdd]
type			= VelAdd
trigger1		= (Parent, StateNo != 730)
y			= 0.05


[State 733:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 15
timegap		= 1
framegap 		= 2
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 110,110,110
trans 		= add

[State 733:	autodestrucción]
type			= DestroySelf
trigger1		= (Pos Y < -210) || (Pos Y >= 1) || (!AnimTime)
;--------------------------------------------

;Kung Fu Throw - Attempt
; CNS difficulty: medium-advanced
; Description: Throws are not difficult to make, although then can be
;     tedious at times. Throw attempt states have a HitDef of a
;     special format. The key parameters in a throw are p1stateno
;     and p2stateno. If the HitDef successfully connects, then
;     the attacker will change to the state number specified by
;     p1stateno, and the opponent will be change to the state
;     number assigned to p2stateno. The special thing about p2stateno
;     is that the opponent will be temporarily brought into the
;     attacker's state file. In this case, no matter who the
;     opponent is, he will be taken to state 820 of this file (kfm.cns)
;     and remain here until the end of the throw (look at his debug
;     information when he is being thrown; the text changes to yellow
;     to mean that he is in another player's state file).
[Statedef 800]
type    = S
movetype= A
physics = S
juggle  = 0
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2

; Notes: The '-' symbol in the hitflag field means that it only affects
;   players who are not in a hit state. This prevents KFM from combo-ing
;   into the throw. The priority should be set to a low number, such as
;   1 or 2, so that the throw does not take precedence over normal attacks.
;   The type of priority must always be set to "Miss" or "Dodge" for throws,
;   otherwise strange behavior can result.
[State 800, 1]
type = HitDef
Trigger1 = Time = 0
attr = S, NT          ;Attributes: Standing, Normal Throw
hitflag = M-          ;Affect only ground people who are not being hit
priority = 1, Miss    ;Throw has low priority, must be miss or dodge type.
sparkno = -1          ;No spark
p1sprpriority = 1     ;Draw p1's sprite in front of p2
                      ;p2's sprite priority is set to 0 by default
p1facing = 1
p2facing = 1          ;Force p2 to face KFM
p1stateno = 810       ;On success, KFM changes to state 810
p2stateno = 820       ;If hit, p2 changes to state 820 in KFM's cns
guard.dist = 0        ;This prevents p2 from going into a guard state if close
fall = 1              ;Force p2 into falling down

[State 800, 2]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Kung Fu Throw - Throwing the opponent
; Description: In this state, KFM throws the opponent by binding him to
;     various offsets based on his current frame of animation. For
;     example, [State 810, Bind 1] binds the opponent to an offset of
;     28 pixels in front of KFM. That puts him around where KFM's hand
;     is at. Is is important to keep the opponent bound using a
;     TargetBind controller at all times, until you let him go. This
;     is especially important if your player has a Clsn2 box that
;     allows him to get hit while throwing someone. Each time a player
;     gets hit, all his bound targets will be set to a fall state. If
;     the opponent is not bound, then he may get stuck in his thrown
;     state when his attacker is knocked out of the throw halfway.
; Notes: There is a TargetLifeAdd controller to decrease the opponent's
;     life, and a TargetState controller to change his state to a
;     falling state when KFM lets go of him.
[Statedef 810]
type    = S
movetype= A
physics = N
anim = 810
poweradd = 60

; Here a variable, var(2), is used to remember whether or not the
; player was holding forward at the start of the state. This variable
; is checked later on to turn KFM around if necessary.
[State 810, Holding fwd?]
type = VarSet
trigger1 = Time = 0
var(2) = command = "holdfwd"

[State 810, Grab Sound]
type = PlaySnd
trigger1 = AnimElem = 2
value = 1, 1

[State 810, Throw Sound]
type = PlaySnd
trigger1 = AnimElem = 7
value = 800, 0

[State 810, Bind 1]
type = TargetBind
trigger1 = AnimElemTime(2) < 0
pos = 28, 0

[State 810, Width 2-11]
type = Width
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(12) < 0
edge = 60,0

[State 810, Bind 2-4]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(5) < 0
pos = 58, 0

[State 810, Bind 5]
type = TargetBind
trigger1 = AnimElemTime(5) >= 0 && AnimElemTime(6) < 0
pos = 47, 0

[State 810, holdfwd - Turn 6] ;If was holding fwd before, turn now
type = Turn
trigger1 = var(2)
trigger1 = AnimElem = 6

[State 810, holdfwd - Pos 6] ;If was holding fwd before, move a little
type = PosAdd
trigger1 = var(2)
trigger1 = AnimElem = 6
x = -37

[State 810, holdfwd - Turn Target 6] ;If was holding fwd before, turn target too
type = TargetFacing
trigger1 = var(2)
trigger1 = AnimElem = 6
value = -1

[State 810, Bind 6]
type = TargetBind
trigger1 = AnimElemTime(6) >= 0 && AnimElemTime(7) < 0
pos = 41, -60

[State 810, Bind 7]
type = TargetBind
trigger1 = AnimElemTime(7) >= 0 && AnimElemTime(8) < 0
pos = 25, -75

[State 810, Bind 8]
type = TargetBind
trigger1 = AnimElemTime(8) >= 0 && AnimElemTime(9) < 0
pos = 15, -90

[State 810, Bind 9]
type = TargetBind
trigger1 = AnimElemTime(9) >= 0 && AnimElemTime(10) < 0
pos = -5, -96

[State 810, Bind 10]
type = TargetBind
trigger1 = AnimElemTime(10) >= 0 && AnimElemTime(11) < 0
pos = -14, -90

[State 810, Bind 11]
type = TargetBind
trigger1 = AnimElem = 11
pos = -50, -50

[State 810, Hurt 11]
type = TargetLifeAdd
trigger1 = AnimElem = 11
value = -78

[State 810, Throw 11]
type = TargetState
trigger1 = AnimElem = 11
value = 821

[State 810, Turn 12]
type = Turn
trigger1 = AnimElem = 12

[State 810, Pos 15]
type = PosAdd
trigger1 = AnimElem = 15
x = -10

[State 810, State End]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw
; (a custom gethit state)
; Description: This is the state that the opponent changes to after being
;     hit by KFM's throw HitDef. The important thing here is to use a
;     ChangeAnim2 controller. The difference between ChangeAnim2 and
;     ChangeAnim is that ChangeAnim2 changes the player's animation to
;     an action in the AIR file of the attacker (in this case, kfm.air),
;     whereas ChangeAnim always changes the player to an action in his
;     own AIR file. Look at Action 820 in kfm.air for some extra
;     comments.
[Statedef 820]
type    = A
movetype= H
physics = N
velset = 0,0

[State 820, 1]
type = ChangeAnim2
Trigger1 = Time = 0
value = 820

;In case attacker loses binding on player for any reason, this controller
;guarantees that the player will never get stuck in this thrown state.
[State 820, 2]
type = SelfState
trigger1 = !gethitvar(isbound)
value = 5050

;---------------------------------------------------------------------------
;Thrown by Kung Fu Throw - thrown into the air
; (a custom gethit state)
; Description: This state has the opponent flying through the air and
;     falling down onto the ground. The SelfState controller sets the
;     opponent back using to his own state file when he his the ground.
;     Controllers 821,2 and 821,3 allow the opponent to recover by
;     hitting his recovery command when he is falling.
[Statedef 821]
type    = A
movetype= H
physics = N
velset = 2.8,-7
poweradd = 40

[State 821, 1] ;Gravity
type = VelAdd
Trigger1 = 1
y = .4

[State 821, 2] ; Recover near ground (use ChangeState)
type = ChangeState
triggerall = Vel Y > 0
triggerall = Pos Y >= -20
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5200 ;HITFALL_RECOVER

[State 821, 3] ; Recover in mid air (use SelfState)
type = SelfState
triggerall = Vel Y > 0
triggerall = alive
triggerall = CanRecover
trigger1 = Command = "recovery"
value = 5210 ;HITFALL_AIRRECOVER

[State 821, 4] ;Hit ground
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100 ;Hit ground


;-----------------------------------------------------------------------
; KAME HAME HA 2!!!
[Statedef 737]
type = S
MoveType =A
physics = S
sprpriority = -3
ctrl=0
anim = 2000; ANIMACION LANZANDO BOLA 
VelSet = 0,0
poweradd = -1000

[State 737]; tiempo para cargar el kame
type = Superpause
trigger1 = time = 0; tiempo en q se activa
time = 35 ;tiempo q dura
darken = 0 ; oscurecer 
movetime = 35 ; tiempo en q se mueve p1
anim = -1

[State 737]
type = PlaySnd
trigger1 = AnimElem= 2
value =748,5
volume = 255

[State 737]
type = PlaySnd
trigger1 = AnimElem= 4
value =748,7
volume = 255

[State 737]
type = PlaySnd
trigger1 = Time = 50
value =748,6
volume = 255

[State 737]; sprites del kame
type = helper
trigger1 = Time = 50
helpertype = normal
name = "kame2"
ID = 738
pos = 34,-47
postype = p1
size.xscale = 1.2
size.yscale = 1.2
stateno = 738
supermovetime = 15
ownpal = 1
pausemovetime = 9999999999999
supermovetime = 9999999999999


[State 737]; sprites bola carga
type = helper
trigger1 = Time = 0
helpertype = normal
name = "bolacarga"
ID = 739
pos = -15,-45
postype = p1
size.xscale = 0.7
size.yscale = 0.7
stateno = 739
supermovetime = 15
ownpal = 1
ontop = 1
pausemovetime = 9999999999999
supermovetime = 9999999999999


[State 737, ScreenBound]; movimiento de camara al impactar a P2
type = ScreenBound
trigger1 = p2movetype = H || (BackEdgeBodyDist < -1)
movecamera = 0,0
value	= 0

[State 737]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500

[State 737]
type = changestate
trigger1  = (!AnimTime)
value = IfElse(BackEdgeBodydist >= -5,0,100)
ctrl = 1
;-------------------------------------------------------------
;continuación kame 2( sprites del kame)
[Statedef 738]
type    = S                      
movetype= A                      
velset = 0,0                
ctrl = 0                    
anim = 2007; sprites del kame
sprpriority = 7






[State 738, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

;[State 0 ]
;type = AfterImage
;trigger1 = (time=0)
;time = 100
;length = 60
;palcolor = 256
;palbright = 30,30,30
;palcontrast = 120,120,20
;palcontrast = 0,169,231
;palmul = .65,.65,.25
:timegap = 1
;framegap = 1
;trans = add
;ignorehitpause = 1

[State 738:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 1000
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add




[State 738]
type = AssertSpecial
trigger1 = time >= 0
flag = noshadow
flag2 = timerfreeze
ignorehitpause = 1


[State 738, EXPLOSION SPRITES]
type			= Explod
trigger1		= MoveContact
anim			= 9001
id			= 9001
pos			= 0,0
postype		= p2
facing		= 1
vfacing		= 1
bindtime		= 1
vel			= 0,0
accel			= 0,0
random		= 0,0
removetime		= -2
supermove		= 0
supermovetime	= 0
pausemovetime	= 0
scale			= 1,1
sprpriority		= 3
ontop			= 0
shadow		= 0,0,0
ownpal		= 1
removeongethit	= 0
persistent		= 0
ignorehitpause	= 1


[State 738]
type			= HitDef
trigger1		= !MoveContact
attr			= S, HP
hitflag		= MAFDP
guardflag		= M
animtype		= Hard
priority		= 7, Hit
damage		= 200
pausetime		= 0,12
guard.pausetime	= 0,20
sparkno		= -1
guard.sparkno	= -1
sparkxy		= 0,0
hitsound		= S9001 
guardsound		= S9001 
ground.type		= Trip
air.type		= Trip
ground.slidetime	= 25
ground.hittime	= 25
air.hittime		= 25
yaccel		= 0.35
ground.velocity	= -25,-3
guard.velocity	= -8
air.velocity	= -25,-3
airguard.velocity	= -25,-3
ground.cornerpush.veloff = 0
fall			= 1
fall.recover	= 0
id			= 738
getpower		= 0
givepower		= 50
palfx.time		= 40
palfx.mul		= 256,256,256
palfx.add		= 200,200,255
palfx.sinadd	= -100,-100,-155,40
;envshake.time 	= 30
;envshake.freq 	= 120
;envshake.ampl 	= -8
;persistent		= 0


[State 738, ScreenBound]
type = ScreenBound
trigger1 = p2movetype = H || (BackEdgeBodyDist < -1)
movecamera = 0,0
value	= 0

[State 738]
type = DestroySelf
trigger1 = AnimTime = 0
;---------------------------------------------------------
; Bola carga
[Statedef 739]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0,0
poweradd= 0                     
anim = 2002 


[State 739:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 40
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add

[State 739]
type = DestroySelf
trigger1 = AnimTime = 0

;-------------------------------------------------------------------------
;--------------------------------------------------------------------------
;--------------------------------------------------------------------------
; FireBall 2; modelo bardock
[Statedef 743]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0,0
poweradd= -200                     
anim = 815 

[State 743]
type = PlaySnd
trigger1 = AnimElem= 2
value =736,0
              
[State 743]
type = Helper
trigger1 = AnimElem = 2
helpertype = normal
name = "Fireball"
id = 744
pos = 20,-50
size.xscale = 0.4
size.yscale = 0.3
stateno = 744
keyctrl = 1
ownpal = 1

[State 743,BOLA CARGA]
type = Explod
trigger1 = animelem = 2
anim = 2011
ID = 2011
postype = p1
pos = 28,-55
sprpriority = 20
removetime =12
bindtime = -1
ownpal = 1
ontop = 1
scale = 0.3,0.3
removeongethit = 1 

[State 743]
type=ChangeState
trigger1=AnimTime=0
value=0
ctrl=1
;--------------------------------------------------------
;Fireball (sprite de magia)
[Statedef 744]
type 			= A
movetype		= A
physics		= N
anim			= 2012
;velset		= 0,0
ctrl			= 0
poweradd		= 0
juggle		= 0
facep2		= 0
hitdefpersist	= 0
movehitpersist	= 0
hitcountpersist	= 0
sprpriority		= 3


[State 744]
type			= NotHitBy
trigger1		= 1
value			= SCA

[State 744]
type			= VelSet
trigger1		= (!Time)
x			= 10
y			= IfElse(Random <= 499,-0.8,0.8)

[State 744]
type			= PalFX
trigger1		= (!Time)
time			= 40
add			= 100,100,100
mul			= 256,256,256
sinadd		= -100,-100,-100,40
invertall		= 0
color			= 256

[State 744:	BGPalFX]
type			= BGPalFX
trigger1		= (MoveHit)
time			= 5
add			= 75,75,75
mul			= 256,256,256
sinadd		= 80,80,80,4
invertall		= 0
color			= 256
persistent		= 0
ignorehitpause	= 1

[State 744 ]
type = AfterImage
trigger1 = time = 0
time = 40
length = 60
palcolor = 256
palbright = 30,30,30
;palcontrast = 120,120,20
palmul = .65,.65,.25
timegap = 1
framegap = 1
trans = add
ignorehitpause = 1


[State 744, EXPLOSION SPRITES]
type			= Explod
trigger1		= MoveContact
anim			= 9001
id			= 9001
pos			= 0,-15
postype		= p2
facing		= 1
vfacing		= 1
bindtime		= 1
vel			= 0,0
accel			= 0,0
random		= 0,0
removetime		= -2
supermove		= 0
supermovetime	= 0
pausemovetime	= 0
scale			= 0.5,0.5
sprpriority		= 20
ontop			= 0
shadow		= 0,0,0
ownpal		= 1
removeongethit	= 0
persistent		= 0
ignorehitpause	= 1

[State 744:	HitDef]
type			= HitDef
trigger1		= !MoveContact
attr			= S, HP
hitflag		= MAFDP
guardflag		= M
animtype		= Hard
priority		= 7, Hit
damage		= 20
pausetime		= 0,12
guard.pausetime	= 0,20
sparkno		= -1
guard.sparkno	= -1
sparkxy		= 0,0
hitsound		= S9001 
guardsound		= S9001 
ground.type		= Trip
air.type		= Trip
ground.slidetime	= 25
ground.hittime	= 25
air.hittime		= 25
ground.velocity	= -8
guard.velocity	= -8
air.velocity	= -8,-3.5
airguard.velocity	= -8,-3.5
ground.cornerpush.veloff = 0
fall.xvelocity	= -1
fall.yvelocity	= -3
fall.recover	= 0
air.fall		= 1
down.velocity	= -1,-2
down.bounce		= 1
id			= 744
getpower		= 0
givepower		= 25
palfx.time		= 12
palfx.mul		= 256,256,256
palfx.add		= 200,50,10
palfx.sinadd	= 175,25,5,4
envshake.time 	= 12
envshake.freq 	= 120
envshake.ampl 	= -4
persistent		= 0

[State 744:	DestroySelf]
type			= DestroySelf
trigger1		= (MoveContact) || (FrontEdgeBodyDist < -10) 
ignorehitpause	= 1
;------------------------------------------------------------------
; FireBall 2; (modelo bardock)
[Statedef 745]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0,0
poweradd= -200                     
anim = 816  

[State 745]
type = PlaySnd
trigger1 = AnimElem= 2
value =736,0
                 
[State 745]
type = Helper
trigger1 = AnimElem = 2
helpertype = normal
name = "Fireball"
id = 746
pos = 20,-50
size.xscale = 0.4
size.yscale = 0.3
stateno = 746
keyctrl = 1
ownpal = 1

[State 7025, 4]
type=ChangeState
trigger1=AnimTime=0
value=0
ctrl=1
;------------------------------------------------------
;Fireball (sprite de magia)
[Statedef 746]
type 			= A
movetype		= A
physics		= N
anim			= 2012
;velset		= 0,0
ctrl			= 0
poweradd		= 0
juggle		= 0
facep2		= 0
hitdefpersist	= 0
movehitpersist	= 0
hitcountpersist	= 0
sprpriority		= 3



[State 746]
type			= NotHitBy
trigger1		= 1
value			= SCA

[State 746]
type			= VelSet
trigger1		= (!Time)
x			= 10
y			= IfElse(Random <= 499,-0.8,0.8)

[State 746]
type			= PalFX
trigger1		= (!Time)
time			= 40
add			= 100,100,100
mul			= 256,256,256
sinadd		= -100,-100,-100,40
invertall		= 0
color			= 256

[State 746]
type			= BGPalFX
trigger1		= (MoveHit)
time			= 5
add			= 75,75,75
mul			= 256,256,256
sinadd		= 80,80,80,4
invertall		= 0
color			= 256
persistent		= 0
ignorehitpause	= 1


[State 746 ]
type = AfterImage
trigger1 = (time=0)
time = 40
length = 60
palcolor = 256
palbright = 30,30,30
palcontrast = 120,120,20
palmul = .65,.65,.25
timegap = 1
framegap = 1
trans = add
ignorehitpause = 1

[State 746, EXPLOSION SPRITES]
type			= Explod
trigger1		= MoveContact
anim			= 9001
id			= 9001
pos			= 0,-15
postype		= p2
facing		= 1
vfacing		= 1
bindtime		= 1
vel			= 0,0
accel			= 0,0
random		= 0,0
removetime		= -2
supermove		= 0
supermovetime	= 0
pausemovetime	= 0
scale			= 0.5,0.5
sprpriority		= 20
ontop			= 0
shadow		= 0,0,0
ownpal		= 1
removeongethit	= 0
persistent		= 0
ignorehitpause	= 1

[State 746:	HitDef]
type			= HitDef
trigger1		= !MoveContact
attr			= S, HP
hitflag		= MAFDP
guardflag		= M
animtype		= Hard
priority		= 7, Hit
damage		= 20
pausetime		= 0,12
guard.pausetime	= 0,20
sparkno		= -1
guard.sparkno	= -1
sparkxy		= 0,0
hitsound		= S9001 
guardsound		= S9001 
ground.type		= high
air.type		= Trip
ground.slidetime	= 25
ground.hittime	= 25
air.hittime		= 25
ground.velocity	= -8
guard.velocity	= -8
air.velocity	= -8,-3.5
airguard.velocity	= -8,-3.5
ground.cornerpush.veloff = 0
fall.xvelocity	= -1
fall.yvelocity	= -3
fall.recover	= 0
air.fall		= 1
down.velocity	= -1,-2
down.bounce		= 1
id			= 746
getpower		= 0
givepower		= 25
palfx.time		= 12
palfx.mul		= 256,256,256
palfx.add		= 200,50,10
palfx.sinadd	= 175,25,5,4
envshake.time 	= 12
envshake.freq 	= 120
envshake.ampl 	= -4
persistent		= 0

[State 745:	Autodestruccion]
type			= DestroySelf
trigger1		= (MoveContact) || (FrontEdgeBodyDist < -10) 
ignorehitpause	= 1

;----------------------------------------------------------------------------
; KAME HAME HA!!!
[Statedef 735]
type = S
MoveType =A
physics = S
sprpriority = -3
ctrl=0
anim = 2000; ANIMACION LANZANDO BOLA 
VelSet = 0,0
poweradd = -1000

[State 1000]
type = PlaySnd
trigger1 = AnimElem= 2
value =200,4


[State 1000]
type = PlaySnd
trigger1 = AnimElem= 8
value =200,5


[State 1000]
type = PlaySnd
trigger1 = AnimElem= 8
value =735,0


[State 2501, Beam]
type = Projectile
trigger1 = AnimElem = 8
getpower  = 0
projanim = 2001
projhitanim = -1
projpriority = 60
ontop = 1
projremovetime = 60
projscale = 0.8,0.8
projid = 2001
projhits = 40
projmisstime = 2
numhits = 4
velocity = 0
accel = 0
offset = 35,-55
attr = S, NA
damage   = 10,8
animtype = Hard
guardflag = MA
hitflag = MAFP
pausetime = 1,1
hitsound   = S15,0
sparkno = -1
guard.sparkno = -1
guardsound = S16,0
ground.type = High
ground.slidetime = 25
ground.hittime  = 15
ground.velocity = -8
air.animtype = High
air.velocity = -2
air.juggle = 2
down.velocity = -4,-6
down.hittime = 30
down.bounce = 0
palfx.time = 23
palfx.add = 0,128,255


[State 1001,BOLA CARGA]
type = Explod
trigger1 = animelem = 1
anim = 2002
ID = 2002
postype = p1
pos = -15,-45
sprpriority = 20
removetime =40
bindtime = -1
ownpal = 1
ontop = 1
scale = 1,1
removeongethit = 1 



[State 735]; sprites aura 1
type = helper
trigger1 = animelem = 8
helpertype = normal
name = "aura"
ID = 741
pos = 0,0
postype = p1
size.xscale = 0.9
size.yscale = 1
stateno = 741
supermovetime = 15
ownpal = 1
ontop = 1
pausemovetime = 9999999999999
supermovetime = 9999999999999


[State 735]; sprites aura 2
type = helper
trigger1 = animelem = 1
helpertype = normal
name = "aura2"
ID = 742
pos = 0,0
postype = p1
size.xscale = 1
size.yscale = 1
stateno = 742
supermovetime = 15
ownpal = 1
ontop = 1
pausemovetime = 9999999999999
supermovetime = 9999999999999



[State 2500, 6]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1
;------------------------------------------------
; aura 1
[Statedef 741]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0,0
poweradd= 0                     
anim = 2003 


[State 739:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 100
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add

[State 738]
type = DestroySelf
trigger1 = Time = 80

;--------------------------------------------------------

; aura 2
[Statedef 742]
type = S
movetype = A
physics = S
ctrl = 0
velset = 0,0,0
poweradd= 0                     
anim = 2004


[State 739:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 40
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add

[State 738]
type = DestroySelf
trigger1 = Time = 42

;--------------------------------------------------------


; Rayos!!!
[Statedef 736]
type = S
MoveType =A
physics = S
sprpriority = -3
ctrl=0
anim = 2006; ANIMACION LANZANDO BOLA 
VelSet = 0,0
poweradd = -500

[State 1000]
type = PlaySnd
trigger1 = AnimElem= 3
value =736,0



[State 2501, Beam]
type = Projectile
trigger1 = AnimElem = 3
getpower  = 0
projanim = 2005
projhitanim = -1
projpriority = 60
ontop = 1
projremovetime = 13
projscale = 0.6,0.6
projid = 2001
projhits = 20
projmisstime = 2
numhits = 4
velocity = 0
accel = 0
offset = 35,-55
attr = S, NA
damage   = 10,8
animtype = Hard
guardflag = MA
hitflag = MAFP
pausetime = 1,1
hitsound   = S15,0
sparkno = -1
guard.sparkno = -1
guardsound = S16,0
ground.type = High
ground.slidetime = 25
ground.hittime  = 15
ground.velocity = -8
air.animtype = High
air.velocity = -2
air.juggle = 2
down.velocity = -4,-6
down.hittime = 30
down.bounce = 0
palfx.time = 23
palfx.add = 0,128,255



[State 2500, 6]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;--------------------------------------------------------------------------------------------------------------------

;comenzando a volar
[Statedef 1510]
type = A
movetype = A
physics = A
velset = 0,-7.7
ctrl = 0
anim = 1510

[State 1510, Ha!]
type = PlaySnd
trigger1 = Time = 2
value = 0, 2
volume = 255

[State 1510, 1]
type = AfterImage
trigger1 = Time = 0
time = 10
trans = add1
TimeGap  = 2
FrameGap = 2
length = 6
PalBright   =   0,  0,  0
PalContrast = 128,128,128
PalAdd      =   0,  0,  0
PalMul      =   1,  1,  1

[State 1510, 2]
type = AfterImage
trigger1 = Time = 0
time = 10
trans = add1
TimeGap  = 2
FrameGap = 2
length = 6
PalBright   =   0,  0,  0
PalContrast = 128,128,128
PalAdd      =   0,  0,  0
PalMul      =   1,  1,  1




[state 1510, 3]
type = changestate
trigger1 = animtime = 0
value = 1500
ctrl = 1

;Flying
[Statedef 1500]
type = A
ctrl = 0
anim = 1500
velset = 0,0,0

[State 1500, VarSet]
type = VarSet
Trigger1 = Time = 0
var(3) = 1

[State 1500, MakeDust1]
type = MakeDust
triggerall = Pos Y >= -80 && Pos Y <= -70
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
pos = -5, 75
spacing = 3

[State 1500, MakeDust2]
type = MakeDust
triggerall = Pos Y >= -70 && Pos Y <= -60
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
pos = -5, 60
spacing = 3

[State 1500, MakeDust3]
type = MakeDust
triggerall = Pos Y >= -60 && Pos Y <= -50
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
pos = -5, 50
spacing = 3

[State 1500, MakeDust4]
type = MakeDust
triggerall = Pos Y >= -50 && Pos Y <= -40
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
pos = -5, 40
spacing = 3

[State 1500, MakeDust5]
type = MakeDust
triggerall = Pos Y >= -40 
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
pos = -5, 30
spacing = 3

;[State 1500, Guard]
;type = ChangeState
;triggerall = P2MoveType = A
;triggerall = P2BodyDist X <= 120
;trigger1 = Command = "holdback"
;value = 130

[State 1500,Para]
type = VelSet
trigger1 = command != "holdfwd"
trigger1 = command != "holdback"
trigger1 = command != "holdup"
trigger1 = command != "holddown"
trigger1 = Var(2) = 0
x = 0
y = 0

[State 1500, Para2]
type = ChangeAnim
trigger1 = command != "holdup"
trigger1 = command != "holddown"
trigger1 = Anim != 1500
value = 1500

[State 1500,Var(1)]
type = VarSet
trigger1 = command != "holdfwd"
trigger1 = command != "holdback"
trigger1 = command != "holdup"
trigger1 = command != "holddown"
trigger1 = Var(2) != 2
trigger2 = Var(2) = 2
trigger2 = Vel Y >= 1.5
v = 2
value = 1

[State 1500,Var(2)]
type = VarSet
trigger1 = Var(2) = 1
trigger1 = Vel Y <= -1.5
v = 2
value = 2

[State 1500,Up]
type = VelAdd
trigger1 = Var(2) = 1
y = -0.3

[State 1500,Down]
type = VelAdd
trigger1 = Var(2) = 2
y = 0.2

[State 1500,End]
type = VelSet
triggerall = Var(2) != 0
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
trigger3 = command = "holdup"
trigger4 = command = "holddown"
y = 0

[State 1500,EndVar]
type = VarSet
trigger1 = command = "holdfwd"
trigger2 = command = "holdback"
trigger3 = command = "holdup"
trigger4 = command = "holddown"
v = 2
value = 0


[State 1500, GoUp1]
type = VelAdd
trigger1 = command = "holdup"
y = -0.3

[State 1500,GoUp2]
type = VelSet
trigger1 = command = "holdup"
trigger1 = Vel Y > 0 
y = 0

[State 1500, GoUpAnim]
type = ChangeAnim
trigger1 = Anim != 1503
trigger1 = command = "holdup"
value = 1503

[State 1500, GoDown1]
type = VelAdd
trigger1 = command = "holddown"
y = 0.3

[State 1500,GoDown2]
type = VelSet
trigger1 = command = "holddown"
trigger1 = Vel Y < 0 
y = 0

[State 1500, GoDownAnim]
type = ChangeAnim
trigger1 = Anim != 1504
trigger1 = command = "holddown"
value = 1504

[State 1500, GoBack1]
type = VelAdd
trigger1 = command = "holdback"
x = -0.3

[State 1500,GoBack2]
type = VelSet
trigger1 = command = "holdback"
trigger1 = Vel X > 0 
x = 0

[State 1500, GoBackAnim]
type = ChangeAnim
triggerall = Anim != 1501
trigger1 = command = "holdback"
value = 1501

[State 1500, GoFwd1]
type = VelAdd
trigger1 = command = "holdfwd"
x = 0.3

[State 1500, GoFwd2]
type = VelSet
trigger1 = command = "holdfwd"
trigger1 = Vel X < 0 
x = 0

[State 1500, GoFwdAnim]
type = ChangeAnim
trigger1 = Anim != 1502
trigger1 = command = "holdfwd"
value = 1502

[State 1500,Turn]
type = Turn
trigger1 = P2Dist X < 0

[State 1500,Border]
type = PosSet
trigger1 = Pos Y < -150
y = -150

[State 1500,Land]
type = ChangeState
trigger1 = Pos Y >= 0
value = 50
ctrl = 1

[State 1500,End]
type = ChangeState
trigger1 = Time > 2
trigger1 = command = "fly"
value = 50
ctrl = 1

[State 1500,Win-Lose]
type = ChangeState
trigger1 = Win = 1
trigger2 = Lose = 1
value = 50


; genkidama
[Statedef 750]
type = S
MoveType =A
physics = S
sprpriority = -3
ctrl=0
anim = 2013; ANIMACION cargando y lanzando la genki  
VelSet = 0,0
poweradd = -1000

;[State 750]; tiempo para cargar el kame
;type = Superpause
;trigger1 = time = 0; tiempo en q se activa
;time = 200 ;tiempo q dura
;darken = 0 ; oscurecer 
;movetime = 200 ; tiempo en q se mueve p1
;anim = -1

[State 750,genki-dama cargando ]
type = PlaySnd
trigger1 = animelem= 12
value = 750,0
volume = 150


[State 750,genki-dama (palabras de goku cargando) ]
type = PlaySnd
trigger1 = animelem= 12
value = 750,1
volume = 255

[State 750, goku lanzando genki-dama ]
type = PlaySnd
trigger1 = animelem= 13
value = 750,2
volume = 255

[State 750, temblor ]
type = PlaySnd
trigger1 = animelem= 12
value = 748,10
volume = 255


[State 750]; sprites de la genki dama
type = helper
trigger1 = animelem = 12
helpertype = normal
name = "genki"
ID = 751
pos = 0,-200
postype = p1
size.xscale = 3
size.yscale = 3
stateno = 751
ownpal = 1
ontop = 1
pausemovetime = 9999999999999
supermovetime = 9999999999999

[State 730:	Rocas levantandose]
type			= Helper
trigger1		= Time > 50 
trigger1          = ((GameTime%10) = 0) 
trigger1          = Random < 249
helpertype		= Normal
name			= "Rocas"
id			= 752
pos			= -20,0
size.xscale       = 0.3
size.yscale       = 0.3
postype		= p1
facing		= 0
stateno		= 752
keyctrl		= 0
ownpal		= 1
supermovetime	= 0
pausemovetime	= 0

[State 730:	Rocas levantandose]
type			= Helper
trigger1		= Time > 50 
trigger1          = ((GameTime%10) = 0) 
trigger1          = Random < 249
helpertype		= Normal
name			= "Rocas"
id			= 753
pos			= -20,0
size.xscale       = 0.3
size.yscale       = 0.3
postype		= p1
facing		= 0
stateno		= 753
keyctrl		= 0
ownpal		= 1
supermovetime	= 0
pausemovetime	= 0




[State 737, ScreenBound]; movimiento de camara al impactar a P2
type = ScreenBound
trigger1 = p2movetype = H || (BackEdgeBodyDist < -1)
movecamera = 0,0
value	= 0

[State 737]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = Pos Y < 0
value = 1500

[State 737]
type = changestate
trigger1  = (!AnimTime)
value = IfElse(BackEdgeBodydist >= -5,0,100)
ctrl = 1
;-------------------------------------------------------------
;continuación 
[Statedef 751]
type    = S                      
movetype= A                      
velset = 0,0                
ctrl = 0                    
anim = 9006; sprites del kame
sprpriority = 100

[State 738, NoHit]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 746]
type			= VelSet
trigger1		= animelem = 5
x			= 4
y			= 2

[State 738:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 1000
timegap		= 2
framegap 		= 3
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 100,100,100
trans 		= add


[State 738]
type = AssertSpecial
trigger1 = time >= 0
flag = noshadow
flag2 = timerfreeze
ignorehitpause = 1


;flash blanco 
;[State 730,1]
;type = Envcolor
;trigger1 = MoveContact
;time = 5



[State 738, EXPLOSION SPRITES]
type			= Explod
trigger1		= MoveContact
anim			= 9001
id			= 9001
pos			= 0,0
postype		= p2
facing		= 1
vfacing		= 1
bindtime		= 1
vel			= 0,0
accel			= 0,0
random		= 0,0
removetime		= -2
supermove		= 0
supermovetime	= 0
pausemovetime	= 0
scale			= 1,1
sprpriority		= 3
ontop			= 0
shadow		= 0,0,0
ownpal		= 1
removeongethit	= 0
persistent		= 0
ignorehitpause	= 1


[State 738]
type			= HitDef
trigger1		= !MoveContact
attr			= S, HP
hitflag		= MAFDP
guardflag		= M
animtype		= Hard
priority		= 7, Hit
damage		= 200
pausetime		= 0,12
guard.pausetime	= 0,20
sparkno		= -1
guard.sparkno	= -1
sparkxy		= 0,0
hitsound		= S9001 
guardsound		= S9001 
ground.type		= Trip
air.type		= Trip
ground.slidetime	= 25
ground.hittime	= 25
air.hittime		= 25
yaccel		= 0.35
ground.velocity	= -25,-3
guard.velocity	= -8
air.velocity	= -25,-3
airguard.velocity	= -25,-3
ground.cornerpush.veloff = 0
fall			= 1
fall.recover	= 0
id			= 738
getpower		= 0
givepower		= 50
envshake.time 	= 30
envshake.freq 	= 120
envshake.ampl 	= -8
persistent		= 0


[State 738, ScreenBound]
type = ScreenBound
trigger1 = p2movetype = H || (BackEdgeBodyDist < -1)
movecamera = 0,0
value	= 0

[State 738]
type = DestroySelf
trigger1 = Time = 600



;--------------------------------------------------------------
;continuación 
; rocas
[Statedef 752]
type = S
movetype = I
physics = N
anim = 9007
ctrl = 0
poweradd = 0
juggle = 0
sprpriority = 100

[State 733:	VarRandom]
type			= VarRandom
trigger1		= (!Time)
v			= 0
range			= -200,200

[State 733:	PosSet]
type			= PosSet
trigger1		= (!Time)
x			= var(0)
y			= 0

[State 733:	VelSet]
type			= VelSet
trigger1		= (Time = 1)
x			= (IfElse(Random <= 799,0,IfElse((Random = [800,900]),-0.2,0.2)))
y			= (IfElse(Random <= 499,-1,-2))

[State 733:	VelAdd]
type			= VelAdd
trigger1		= (Parent, StateNo != 750)
y			= 0.05


[State 733:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 15
timegap		= 1
framegap 		= 2
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 110,110,110
trans 		= add

[State 733:	autodestrucción]
type			= DestroySelf
trigger1		= (Pos Y < -210) || (Pos Y >= 1) ;|| (!AnimTime)

; rocas
[Statedef 753]
type = S
movetype = I
physics = N
anim = 9007
ctrl = 0
poweradd = 0
juggle = 0
sprpriority = 100

[State 733:	VarRandom]
type			= VarRandom
trigger1		= (!Time)
v			= 0
range			= -200,200

[State 733:	PosSet]
type			= PosSet
trigger1		= (!Time)
x			= var(0)
y			= 0

[State 733:	VelSet]
type			= VelSet
trigger1		= (Time = 1)
x			= (IfElse(Random <= 799,0,IfElse((Random = [800,900]),-0.2,0.2)))
y			= (IfElse(Random <= 499,-1,-2))

[State 733:	VelAdd]
type			= VelAdd
trigger1		= (Parent, StateNo != 750)
y			= 0.05


[State 733:	AfterImage]
type			= AfterImage
trigger1 		= (!Time)
time 			= 15
timegap		= 1
framegap 		= 2
length 		= 10
paladd 		= 0, 0, 0
palmul 		= .50, .50, .50
palcontrast 	= 110,110,110
trans 		= add

[State 733:	autodestrucción]
type			= DestroySelf
trigger1		= (Pos Y < -210) || (Pos Y >= 1) ;|| (!AnimTime)
;-------------------------------------------------

;Zanzoken
[Statedef 900]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 900
ctrl = 0
facep2 = 1

[State 1600, invisible]
type = AssertSpecial
trigger1 = 1
flag = Invisible
flag2	= NoWalk

[State 1600, NotHitBy]
type = NotHitBy
Trigger1 = 1
value = SCA
time = 30

[State 1600, Helper]
type = Helper
trigger1 = time = 0
helpertype = Normal
name = "Zanzoken"
id = 900
pos = 0,0
postype = p1
facing = 1
stateno = 902
keyctrl = 0
ownpal = 1

[State 1601, 1]
type = PlaySnd
Trigger1 = AnimElem = 1
value = 100,1
volume = 255

[State 1600, Fwd]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command != "holdback"
Trigger1 = command != "holdup"
Trigger1 = command != "holddown"
x = 300
y = 0

[State 1600, FwdUp]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command = "holdup"
Trigger1 = command = "holdfwd"
Trigger1 = command != "holdback"
Trigger1 = command != "holddown"
x = 300
y = -100

[State 1600, Back]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command = "holdback"
Trigger1 = command != "holdfwd"
Trigger1 = command != "holdup"
Trigger1 = command != "holddown"
x = -300
y = 0

[State 1600, BackUp]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command  = "holdback"
Trigger1 = command  = "holdup"
Trigger1 = command != "holdfwd"
Trigger1 = command != "holddown"
x = -300
y = -100

[State 1600, Up]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command  = "holdup"
Trigger1 = command != "holdfwd"
Trigger1 = command != "holdback"
Trigger1 = command  != "holddown"
x = 0
y = -100

[State 1600, down]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command  = "holddown"
Trigger1 = command != "holdfwd"
Trigger1 = command != "holdback"
Trigger1 = command != "holdup"
x = 0
y = (pos y)*-1

[State 1600, Fwddown]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command  = "holddown"
Trigger1 = command  = "holdfwd"
Trigger1 = command != "holdback"
Trigger1 = command != "holdup"
x = 300
y = (pos y)*-1

[State 1600, Backdown]
type = PosAdd
Trigger1 = time = 10
Trigger1 = command  = "holddown"
Trigger1 = command != "holdfwd"
Trigger1 = command  = "holdback"
Trigger1 = command != "holdup"
x = -300
y = (pos y)*-1

[State 1600, Turn]
type = Turn
Trigger1 = P2Dist X < 0

[State 1600, 4]
type = ChangeState
Trigger1 = Time = 10
value = 901
ctrl = 1
;--------------------
;Zanzoken Appear
[Statedef 901]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 901
ctrl = 1
facep2 = 1

[State 1601, 1]
type = PlaySnd
Trigger1 = AnimElem = 1
value = 100,1
volume = 255

[State 1600, invisible]
type = AssertSpecial
trigger1 = 1
flag = Invisible
flag2	= NoWalk

;[State 1601, 0]
type = AfterImage
trigger1 = Time = 0
time = 10
trans = add1
TimeGap  = 1
FrameGap = 1
length = 15
PalContrast = 256,256,256
PalMul = .5, .5, .5
PalBright = 0,  0,  0
PalAdd = 0,  0,  0

[State 737]
type = ChangeState
trigger1 = Time = 0
trigger1 = Pos Y < 0
value = 1500

[State 1601, 5]
type = ChangeState
Trigger1 = time = 0
value = 0
ctrl = 1

;Zanzoken
[Statedef 902]
type    = S
movetype= I
velset = 0,0,0
anim = 900
ctrl = 0
facep2 = 1

[State 1600, NotHitBy]
type = NotHitBy
Trigger1 = 1
value = SCA
time = 30

[State 1600, AfterImage]
type = AfterImage
trigger1 = time = 15
time = 30
trans = add
TimeGap = 2
FrameGap = 2
length = 20
PalContrast = 256,256,256
PalMul = .5, .5, .5
PalBright = 0,  0,  0
PalAdd = 0,  0,  0

[State 1600, invisible]
type = AssertSpecial
trigger1 = time > 30
flag = Invisible
flag2	= NoWalk

[state 330, 9]
type = destroyself
trigger1 = time = 50

;---------------------------------------------------------------------------
; Override common states (use same number to override) :
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are always executed (use statedef -2)
;---------------------------------------------------------------------------

;---------------------------------------------------------------------------
; States that are executed when in self's state file (use statedef -3)
;---------------------------------------------------------------------------

[Statedef -3]

;This controller plays a sound everytime KFM lands from a jump, or
;from his back-dash.

[State -3, JUMP Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 40 ;Jump land
;trigger2 = stateno = 50 ;Jump land
value = S742, 0

[State -3, JUMP Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 40 ;Jump land
;trigger2 = stateno = 50 ;Jump land
value = S745, 0


[State -3, Landing Sound]
type = PlaySnd
triggerall = Time = 1
trigger1 = stateno = 52 ;Jump land
trigger2 = stateno = 106 ;Run-back land
value = 743, 0
